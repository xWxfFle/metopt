# Решение задачи условной оптимизации методом множителей Лагранжа

**Ф.И.О.:** Филатов Арсений Сергеевич  
**Поток:** 1.2

## Описание

Программа для решения задачи условной оптимизации с использованием метода множителей Лагранжа. Реализует полный цикл решения задачи, включая построение функции Лагранжа, решение системы необходимых условий, проверку характера найденных точек с помощью критерия Сильвестра и визуализацию результатов.

## Задача

### Целевая функция:
```
min f(x,y) = x² + 3y²
```

### Ограничения:
```
g₁(x,y) = x² + y² - 1 = 0
g₂(x,y) = (x-1)² + (y-1)² - 2 = 0
```

## Метод решения

### Метод множителей Лагранжа

Метод множителей Лагранжа используется для решения задач условной оптимизации, где требуется найти экстремум функции при наличии ограничений-равенств.

#### Шаг 1: Построение функции Лагранжа

Функция Лагранжа имеет вид:
```
L(x,y,λ₁,λ₂) = f(x,y) - λ₁·g₁(x,y) - λ₂·g₂(x,y)
```

Для нашей задачи:
```
L(x,y,λ₁,λ₂) = x² + 3y² - λ₁(x² + y² - 1) - λ₂((x-1)² + (y-1)² - 2)
```

#### Шаг 2: Необходимые условия экстремума

Для нахождения стационарных точек необходимо решить систему уравнений:

```
∂L/∂x = 0
∂L/∂y = 0
∂L/∂λ₁ = 0  (это ограничение g₁ = 0)
∂L/∂λ₂ = 0  (это ограничение g₂ = 0)
```

Получаем систему:
```
2x - 2λ₁x - 2λ₂(x-1) = 0
6y - 2λ₁y - 2λ₂(y-1) = 0
x² + y² = 1
(x-1)² + (y-1)² = 2
```

#### Шаг 3: Решение системы уравнений

Система решается численно с использованием метода `fsolve` из библиотеки `scipy.optimize`.

#### Шаг 4: Проверка характера точек (критерий Сильвестра)

Для проверки характера найденных точек используется матрица Гессе функции Лагранжа:

```
H = [∂²L/∂x²    ∂²L/∂x∂y]
    [∂²L/∂y∂x   ∂²L/∂y² ]
```

Элементы матрицы:
```
∂²L/∂x² = 2 - 2λ₁ - 2λ₂
∂²L/∂x∂y = 0
∂²L/∂y² = 6 - 2λ₁ - 2λ₂
```

**Критерий Сильвестра для условного экстремума:**

Для задачи с ограничениями-равенствами необходимо проверить знакоопределенность матрицы Гессе на касательном пространстве к многообразию ограничений. В данном случае, так как у нас 2 ограничения и 2 переменные, касательное пространство имеет размерность 0 (точки пересечения двух кривых).

Для определения характера точки:
1. Проверяем линейную независимость градиентов ограничений
2. Вычисляем собственные значения матрицы Гессе
3. Сравниваем значения целевой функции в найденных точках

## Результаты решения

### Найденные стационарные точки:

**Точка 1 (локальный минимум):**
- x* = 0.911438
- y* = -0.411438
- λ₁* = 1.055089
- λ₂* = 0.566947
- f(x*,y*) = 1.338562

**Точка 2:**
- x = -0.411438
- y = 0.911438
- λ₁ = 2.944911
- λ₂ = -0.566947
- f(x,y) = 2.661438

### Проверка ограничений:

Обе точки точно удовлетворяют ограничениям (погрешность < 10⁻¹⁴).

### Анализ характера точек:

**Точка 1:**
- Матрица Гессе имеет собственные значения разных знаков (-1.244 и 2.756)
- Определитель матрицы Гессе: det(H) = -3.429 < 0
- Градиенты ограничений линейно независимы
- **Вывод:** Это локальный минимум (наименьшее значение функции среди стационарных точек)

**Точка 2:**
- Матрица Гессе имеет собственные значения разных знаков (-2.756 и 1.244)
- Определитель матрицы Гессе: det(H) = -3.429 < 0
- Градиенты ограничений линейно независимы
- **Вывод:** Не является минимумом (большее значение функции)

## Инструкция по запуску

### Шаг 1: Установка зависимостей

```bash
pip install -r requirements.txt
```

Необходимые библиотеки:
- numpy
- scipy
- sympy
- matplotlib

### Шаг 2: Запуск программы

```bash
python lagrange_multiplier.py
```

### Результаты

После запуска программа:
1. Выводит функцию Лагранжа и систему необходимых условий
2. Находит все стационарные точки
3. Проверяет характер точек с помощью критерия Сильвестра
4. Создает графики визуализации (сохраняются в `solution_visualization.png` и `.pdf`)
5. Выводит итоговый результат с оптимальной точкой

## Визуализация

Программа создает два графика:

1. **Линии уровня целевой функции и ограничения** - показывает геометрическую интерпретацию задачи
2. **3D поверхность целевой функции** - отображает поверхность f(x,y) и кривые ограничений на ней

## Математический анализ

### Геометрическая интерпретация

Ограничения задают:
- **g₁:** Окружность единичного радиуса с центром в начале координат
- **g₂:** Окружность радиуса √2 с центром в точке (1,1)

Точки пересечения этих окружностей и являются допустимыми точками задачи.

### Аналитическое решение

Из системы уравнений можно получить аналитические выражения, но они достаточно сложны. Численное решение более эффективно и дает точные результаты.

### Достаточные условия

Для задачи с двумя ограничениями-равенствами и двумя переменными:
- Касательное пространство имеет размерность 0
- Достаточно сравнить значения функции в найденных стационарных точках
- Точка с минимальным значением является локальным минимумом

## Технические детали реализации

### Ключевые функции:
- `solve_lagrange_analytical()` - построение функции Лагранжа и системы уравнений
- `solve_lagrange_numerical()` - численное решение системы уравнений
- `check_sylvester_criterion()` - проверка характера точек с помощью критерия Сильвестра
- `visualize_solution()` - создание графиков визуализации

### Используемые библиотеки:
- **sympy** - для символьных вычислений и построения функции Лагранжа
- **scipy.optimize.fsolve** - для численного решения системы нелинейных уравнений
- **numpy** - для работы с матрицами и вычисления собственных значений
- **matplotlib** - для визуализации результатов

## Заключение

Метод множителей Лагранжа успешно применен для решения задачи условной оптимизации. Найдены две стационарные точки, из которых точка с координатами (0.911438, -0.411438) является локальным минимумом с значением целевой функции 1.338562.

Проверка с помощью критерия Сильвестра подтвердила характер найденных точек. Градиенты ограничений линейно независимы во всех найденных точках, что гарантирует регулярность ограничений.

